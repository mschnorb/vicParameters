array(rep(lon,4),dim=c(3,4)
)
t(array(rep(lon,4),dim=c(3,4)))
lat_arr <- array(rep(lat, times=length(lon)), dim=c(length(lat), length(lon)))
lon_arr <- t(array(rep(lon, times=length(lat)), dim=c(length(lon), length(lat))))
lat_arr
lon_arr
re <- 6378.1370  # equatorial radius (km)
rp <- 6356.7523  # polar radius (km)
lat1 <- pi/180*(lat_arr - 0.0625/2)  # latitude bound - south
lat2 <- pi/180*(lat_arr + 0.0625/2)  # latitude bound - north
lon1 <- pi/180*(lon_arr - 0.0625/2)  # longitude bound - west
lon2 <- pi/180*(lon_arr + 0.0625/2)  # longitude bound - east
#Geocentric Earth radius (https://en.wikipedia.org/wiki/Earth_radius)
RAD <- sqrt(((re^2 * cos(pi/180*lat_arr))^2 + (rp^2 * sin(pi/180*lat_arr))^2) /
((re*cos(pi/180*lat_arr))^2 + (rp*sin(pi/180*lat_arr))^2))
#Northing and easting distance using haversine (https://en.wikipedia.org/wiki/Haversine_formula)
DN  <- 2*RAD*1000*asin(sqrt((sin((lat2-lat1)/2))^2 + cos(lat1)*cos(lat2)*(sin((lon1-lon1)/2))^2))
DEs <- 2*RAD*1000*asin(sqrt((sin((lat1-lat1)/2))^2 + cos(lat1)*cos(lat1)*(sin((lon2-lon1)/2))^2))
DEn <- 2*RAD*1000*asin(sqrt((sin((lat2-lat2)/2))^2 + cos(lat2)*cos(lat2)*(sin((lon2-lon1)/2))^2))
#Estimate area by assuming cell has shape of isoceles trapezoid (Brahmagupta's formula)
a <- max(DEs, DEn)
b <- min(DEs, DEn)
AREA <- 1/4 * sqrt((a+b)^2 * (a-b+2*DN) * (b-a+2*DN))
AREA
t(AREA)
x <- c(1.234567789, 9.67453678, -0.0097654, -2.345098574)
sprintf("%12.4f", x)
sprintf("%8.4f", x)
x <- c(1.234567789, 9.67453678, -0.0097654, -2.345098574, 0.000346)
sprintf("%8.4f", x)
sprintf("%8.5f", x)
sprintf("%6.2f", x)
sprintf("%6.3f", x)
.95-.85
(.95-.85)/0.01
(.95-.85)/0.001
.50/.01
.50/.001
plot_veg_hypsometry(hru_bchlj_200)
ggsave(filename="../../figures/veg_hypso_bchlj_200.png", widhth=6, height=4, units="in", dpi=600)
ggsave(filename="../../figures/veg_hypso_bchlj_200.png", width=6, height=4, units="in", dpi=600)
install.packages("GEVcdn")
library("GEVcdn", lib.loc="~/R/win-library/3.3")
View(hru_bchsg_200)
(hru_bchsg_200$CELL_ID==377256)
which(hru_bchsg_200$CELL_ID==377256)
bands <- hru_bchsg_200[which(hru_bchsg_200$CELL_ID==377256,)]
bands <- hru_bchsg_200[which(hru_bchsg_200$CELL_ID==377256),]
View(bands)
band_ids <- bands$BAND_ID
no_bands <- length(band_ids)
recs <- hru_bchsg_200[which(hru_bchsg_200$CELL_ID==cell),]
recs <- hru_bchsg_200[which(hru_bchsg_200$CELL_ID==377256),]
View(recs)
find.cell.area <- function(cellid,
area_df){
ii <- which(area_df$CELL_ID == cellid)
return(area_df$CELL_AREA[ii]) }
hru_df <- hru_bchsg_200
hru_df <- arrange(hru_df, CELL_ID, BAND_ID, CLASS)
library("plyr", lib.loc="~/R/win-library/3.3")
hru_df <- arrange(hru_df, CELL_ID, BAND_ID, CLASS)
cells <- unique(hru_df$CELL_ID)
no_cells <- length(cells)
cell_area_df <- ddply(hru_df, .(CELL_ID), summarise, CELL_AREA=sum(AREA))
area_vector <- sapply(hru_df$CELL_ID, find.cell.area, cell_area_df)
hru_df$AREA_FRAC <- hru_df$AREA/area_vector
band_df <- ddply(hru_df, .(CELL_ID, BAND_ID), summarise, AREA_FRAC=sum(AREA_FRAC),
ELEVATION=mean(ELEVATION))
cell <- 377256
recs <- hru_df[which(hru_df$CELL_ID==cell),]
no_recs <- length(recs[[1]])
bands <- band_df[which(band_df$CELL_ID==cell),]
band_ids <- bands$BAND_ID
no_bands <- length(band_ids)
area_corr <- 1 + (1 - sum(recs$AREA_FRAC))/sum(recs$AREA_FRAC)
HRU_AF <- recs$AREA_FRAC * area_corr
BAND_AF <- bands$AREA_FRAC * area_corr
band_index <- which(band_ids == recs$BAND_ID[1])-1
which(band_ids == recs$BAND_ID[1])
View(hru_fraser_200)
View(hru_fraser_200)
View(importHruTable)
getwd()
hru_fraserv3_200 <- importHruTable("../../processing/hru_tables/hru_fraser_v3_200.txt")
View(hru_fraserv3_200)
hru_harri_200 <- subset.hru.frame("HARRI", fraser_cell_map, hru_fraserv3_200)
View(hru_harri_200)
make_VIC_param(hru_fraserv3_200, root_depths, vpf_filename = "vpf_fraser_v3_200.txt", snb_filename = "snb_fraser_v3_200.txt")
View(hru_columbia_200_qc)
View(root_depths)
View(columbia_subbasin_cells_v6)
library(readr)
columbia_cell_map <- read_csv("Z:/projects/hydrology/vic_gen2/input/rgm_mapping/input/columbia_v6_cell_map.csv")
View(columbia_cell_map)
rm(hru_columbia_200)
hru_columbia_200 <- hru_columbia_200_qc
rm(hru_columbia_200_qc)
View(hru_columbia_200)
getwd()
save(hru_columbia_200, root_depths, columbia_cell_map, file="Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/input/columbia200.RData")
ind <- which(columbia_cell_map$NAME=="KICHO")
ind
cells <- columbia_cell_map$CELL_ID[ind]
cells
str(cells)
inFrame <- do.call(rbind, lapply(cells, function(x, df){df[which(df$CELL_ID==x),]}, hru_columbia_200))
environment()
e <- environment()
e
str(e)
e[[1]]
e[[root_depths]]
e[["root_depths"]]
View(hru_peace_200)
View(columbia_cell_map)
library(readr)
peace_cell_map <- read_csv("Z:/projects/hydrology/vic_gen2/input/rgm_mapping/input/peace_v3_cell_map.csv")
View(peace_cell_map)
getwd()
save(hru_peace_200, root_depths, peace_cell_map, file = "../input/peace200.RData")
View(hru_fraserv3_200)
which(hru_fraserv3_200$CELL_ID==307520)
which(hru_fraser_200$CELL_ID==307520)
which(hru_fraserv3_200$CELL_ID==303156)
which(hru_fraser_200$CELL_ID==303156)
View(hru_fraser_200)
unique(hru_fraserv3_200$CELL_ID)
length(unique(hru_fraserv3_200$CELL_ID))
library(readr)
fraser_cell_list <- read_csv("Z:/projects/hydrology/vic_gen2/input/vegetation/hru/fraser_cell_list.csv")
View(fraser_cell_list)
unique(hru_fraserv3_200$CELL_ID)[8331]
View(fraser_cell_map)
rm(hru_fraser_200)
hru_fraser_200 <- hru_fraserv3_200
rm(hru_fraserv3_200)
View(hru_fraser_200)
save(hru_fraser_200, root_depths, fraser_cell_map)
save(hru_fraser_200, root_depths, fraser_cell_map, file="../input/fraser200.RData")
adf <- data.frame(YEAR=NULL)
adf$B! <- 1:10
adf$B1 <- 1:10
adf <- data.frame(YEAR=NA)
adf$B1 <- 1:10
View(adf)
rm(adf)
bdf <- data.frame(BASIN=1:10, MBAL=NULL)
bdf <- data.frame(BASIN=1:10, MBAL=0)
adf <- data.frame(YEAR=0)
adf$B1 <- 1:10
View(adf)
View(bdf)
rm(adf, bdf)
a.out <- NULL
a.out <- c(a.out,1)
a.out
a.out <- c(a.out,4.5)
a.out
a <- 1:10
a <- c(a,1:10)
a <- c(a,1:10)
a
array(a, dim=c(10,3))
as.data.frame(array(a, dim=c(10,3)))
matrix(a, nrow=10)
data.frame(matrix(a, nrow=10))
as.Date("2000-01-01")
str(as.Date("2000-01-01"))
as.Date("2000-01-01") > as.Date("1999-01-01")
as.Date("2000-01-01") == as.Date("1999-01-01")
as.Date(paste(2000,7,1, sep="-"))
as.Date(paste(2000,7,1, sep=" "))
as.Date(paste(2000,7,1, sep="/"))
as.Date(paste(2000,7,1, sep="-"))
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/importHruTable.r')
importHruTable("Z:/projects/hydrology/vic_gen2/input/vegetation/hru/processing/hru_tables/hru_vanisle_200.txt")
View(hru_bchsg_200)
hru_vanisle_200 <- importHruTable("Z:/projects/hydrology/vic_gen2/input/vegetation/hru/processing/hru_tables/hru_vanisle_200.txt")
View(hru_vanisle_200)
View(hru_peace_200)
plot_hypsometry(hru_vanisle_200)
plot_veg_hypsometry(hru_vanisle_200)
names(hru_vanisle_200) <- c("POLY_ID", "CLASS", "CELL_ID", "ELEVATION", "AREA)
""
)
names(hru_vanisle_200) <- c("POLY_ID", "CLASS", "CELL_ID", "ELEVATION", "AREA")
View(hru_vanisle_200)
View(hru_peace_200)
names(hru_vanisle_200) <- c("POLY_ID", "CLASS", "CELL_ID", "BAND_ID", "ELEVATION", "AREA")
View(hru_vanisle_200)
plot_veg_hypsometry(hru_vanisle_200)
summarize.df(hru_vanisle_200)
summarizeHRU(hru_vanisle_200)
View(plot_veg_hypsometry)
install.packages(c("digest", "dotCall64", "foreach", "geosphere", "glue", "hexbin", "hms", "iterators", "lazyeval", "lmomco", "lubridate", "Matrix", "mgcv", "R.utils", "raster", "rasterVis", "Rcpp", "reshape2", "rgdal", "rgeos", "rlang", "sp", "spam", "stringi", "tibble", "zoo"))
library("plyr", lib.loc="~/R/win-library/3.4")
ddply(hru_vanisle_200, .(CELL_ID, CLASS), summarize, area=SUM(AREA))
ddply(hru_vanisle_200, .(CELL_ID, CLASS), summarize, area=sum(AREA))
tmp <- ddply(hru_vanisle_200, .(CELL_ID, CLASS), summarize, area=sum(AREA))
View(tmp)
vanisle_200_hru_param <- make_VIC_param(hru_vanisle_200, root_depths, vpf_filename = "vpf_vanisle_200.txt", snb_filename = "snb_vanisle_200.txt")
plot_veg_hypsometry(hru_vanisle_200)
f <- function(v){return(sapply(v, function(x, xn, xx) ((x-xn)/(xx-xn)), xn=min(v), xx=max(v)))}
f(rep(5,10))
View(plot_hypsometry)
View(plot_veg_hypsometry)
View(hru_peace_200)
View(hru_columbia_200)
View(hru_fraser_200)
tmp <- cbind(hru_peace_200[1:4], hru_peace_200[6:7])
View(tmp)
hru_peace_200 <- tmp
rm(tmp)
plot_veg_hypsometry(rbind(hru_peace_200, hru_fraser_200, hru_columbia_200))
rm(gbulwa, gbulwa_bycell)
rm(bulwa200g_200)
View(inFrame)
rm(inFrame)
ggsave("Z:/projects/hydrology/vic_gen2/input/vegetation/hru/figures/veg_hpsometry_200_peace_fraser_columbia.png")
ggsave("Z:/projects/hydrology/vic_gen2/doc/manuals/vegetation/Figures/veg_hpsometry_200_peace_fraser_columbia.png")
ggsave("Z:/projects/hydrology/vic_gen2/doc/manuals/vegetation/Figures/veg_hpsometry_200_peace_fraser_columbia.png", width = 20, height = 24, units="cm", dpi=600)
View(hru_bulwa_200)
View(hru_bulwa_500)
tmp <- order(hru_bulwa_500$BAND_ID, hru_bulwa_500$CLASS)
tmp <- hru_bulwa_500[,order(hru_bulwa_500$BAND_ID, hru_bulwa_500$CLASS)]
tmp <- hru_bulwa_500[order(hru_bulwa_500$BAND_ID, hru_bulwa_500$CLASS),]
View(tmp)
tmp <- hru_bulwa_500[order(hru_bulwa_500$BAND_ID, hru_bulwa_500$CLASS, hru_bulwa_500$ELEVATION),]
tmp <- hru_bulwa_500[order(hru_bulwa_500$BAND_ID, hru_bulwa_500$CLASS, hru_bulwa_500$ELEVATION, hru_bulwa_500$AREA),]
View(tmp)
tmp <- hru_bulwa_500[order(hru_bulwa_500$BAND_ID, hru_bulwa_500$CLASS, hru_bulwa_500$AREA),]
tmp$AREAF <- tmp$AREA/5000/6000
library("ggplot2", lib.loc="~/R/win-library/3.4")
ggplot(data=tmp, x=BAND_ID) + geom_dotplot()
ggplot(data=tmp, aes(x=BAND_ID)) + geom_dotplot()
ggplot(data=tmp, aes(x=BAND_ID)) + geom_dotplot(binwidth=200)
ggplot(data=tmp, aes(x=BAND_ID)) + geom_dotplot(binwidth=500)
ggplot(data=tmp, aes(x=BAND_ID)) + geom_dotplot(binwidth=100)
ggplot(data=hru_bulwa_200, aes(x=BAND_ID)) + geom_dotplot(binwidth=100)
ggplot(data=hru_bulwa_200, aes(x=BAND_ID)) + geom_dotplot(binwidth=10)
ggplot(data=hru_bulwa_200, aes(x=BAND_ID)) + geom_dotplot(binwidth=100)
ggplot(data=hru_bulwa_200, aes(x=BAND_ID)) + geom_dotplot()
ggplot(data=hru_bulwa_200, aes(x=BAND_ID)) + geom_dotplot(bins=50)
ggplot(data=hru_bulwa_200, aes(x=BAND_ID)) + geom_dotplot(binwidht=50)
ggplot(data=hru_bulwa_200, aes(x=BAND_ID)) + geom_dotplot(binwidth=50)
ggplot(data=hru_peyto_200_v2, aes(x=BAND_ID)) + geom_dotplot(binwidth=50)
ggplot(data=hru_peace_200, aes(x=BAND_ID)) + geom_dotplot(binwidth=50)
ggplot(data=hru_peace_200, aes(x=BAND_ID)) + geom_dotplot(binwidth=50) + scale_y_continuous(limits=c(0,2))
ggplot(data=hru_peace_200, aes(x=BAND_ID)) + geom_dotplot(binwidth=50) + scale_y_continuous(limits=c(0,5))
ggplot(data=hru_peace_200, aes(x=BAND_ID)) + geom_dotplot(binwidth=50) + scale_y_continuous(limits=c(0,20))
ggplot(data=hru_peace_200, aes(x=BAND_ID)) + geom_dotplot(binwidth=50) + scale_y_continuous(limits=c(0,505))
ggplot(data=hru_peace_200, aes(x=BAND_ID)) + geom_dotplot(binwidth=50) + scale_y_continuous(limits=c(0,5000))
ggplot(data=hru_peace_200, aes(x=BAND_ID)) + geom_dotplot(binwidth=50) + scale_y_continuous(limits=c(0,50000))
ggplot(data=hru_peace_200, aes(x=BAND_ID)) + geom_dotplot(binwidth=50) + scale_y_continuous(limits=c(0,500000))
ggplot(data=hru_peace_200, aes(x=BAND_ID)) + geom_dotplot(binwidth=1000)
ggplot(data=hru_peace_200, aes(x=BAND_ID)) + geom_dotplot(binwidth=200, method = "histodot")
ggplot(data=hru_peace_200, aes(x=BAND_ID)) + geom_dotplot(binwidth=50, method = "histodot")
ggplot(data=hru_peace_200, aes(x=ELEVATION)) + geom_dotplot(binwidth=200, method = "histodot")
ggplot(data=hru_peace_200, aes(x=ELEVATION)) + geom_dotplot(binwidth=10, method = "histodot")
tmp$CAREAF <- NA
subset(tmp$BAND_ID==750)
subset(tmp,BAND_ID==750)
subset(tmp,BAND_ID==750)$CAREAF
subset(tmp,BAND_ID==750)$CAREAF <- cumsum
subset(tmp,BAND_ID==750)$CAREAF <- cumsum(subset(tmp,BAND_ID==750)$AREAF)
tmp[subset(tmp,BAND_ID==750),]$CAREAF
subset(tmp,BAND_ID==750)$CAREAF
tmp$BAND_ID==750
which(tmp$BAND_ID==750)
tmp$CAREAF[which(tmp$BAND_ID==750)]
tmp$CAREAF[which(tmp$BAND_ID==750)] <- cumsum(tmp$AREAF[which(tmp$BAND_ID==750)])
unique(tmp$BAND_ID)
for(b in unique(tmp$BAND_ID)){
tmp$CAREAF[which(tmp$BAND_ID==b)] <- cumsum(tmp$AREAF[which(tmp$BAND_ID==b)])
}
ggplot(data=tmp, aes(x=CAREAF, y=BAND_ID)) + geom_point()
ggplot(data=tmp, aes(x=CAREAF, y=BAND_ID, color=CLASS)) + geom_point()
ggplot(data=tmp, aes(x=CAREAF, y=BAND_ID, color=factor(CLASS))) + geom_point()
View(set_veg_legend)
View(hru_kicho_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(bulwa_100_params)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(bulwa_100_params)
View(hru_bulwa_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
View(hru_bulwa_200)
plot_hru_hypsometry(bulwa_100_params)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
debugSource('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
debugSource('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(bulwa_100_params)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
debugSource('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(bulwa_100_params)
names(hru_df)
plot_hru_hypsometry(bulwa_100_params)
plot_hru_hypsometry(hru_bulwa_200)
debugSource('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_bulwa_200)
plot_hru_hypsometry(hru_bulwa_200)
debugSource('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_bulwa_200)
Q
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_bulwa_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_bulwa_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_bulwa_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_bulwa_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_bulwa_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_bulwa_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_bulwa_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_bulwa_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_bulwa_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_bulwa_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_bulwa_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_bulwa_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_bulwa_200)
plot_hru_hypsometry(hru_fraser_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_fraser_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_fraser_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_fraser_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_fraser_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_fraser_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_fraser_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_fraser_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_fraser_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_fraser_200)
View(hru_fraser_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
View(hru_fraser_200)
plot_hru_hypsometry(hru_fraser_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_fraser_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_fraser_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_fraser_200)
tmp <- hru_fraser_200[order(hru_fraser_200$BAND_ID, hru_fraser_200$CLASS),]
View(tmp)
rm(tmp)
plot_hru_hypsometry(hru_columbia_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_columbia_200)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_columbia_200)
ggsave("Z:/projects/hydrology/vic_gen2/doc/manuals/vegetation/tmp.png", width=8, height=6 units="in", dpi=600)
ggsave("Z:/projects/hydrology/vic_gen2/doc/manuals/vegetation/tmp.png", width=8, height=6, units="in", dpi=600)
ggsave("Z:/projects/hydrology/vic_gen2/doc/manuals/vegetation/tmp.png", width=12, height=8, units="in", dpi=600)
ggsave("Z:/projects/hydrology/vic_gen2/doc/manuals/vegetation/tmp.png", width=12, height=10, units="in", dpi=600)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
ggsave("Z:/projects/hydrology/vic_gen2/doc/manuals/vegetation/tmp.png", width=12, height=10, units="in", dpi=600)
plot_hru_hypsometry(hru_columbia_200)
ggsave("Z:/projects/hydrology/vic_gen2/doc/manuals/vegetation/tmp.png", width=12, height=8, units="in", dpi=600)
plot_hru_hypsometry(hru_peace_200)
ggsave("Z:/projects/hydrology/vic_gen2/doc/manuals/vegetation/tmp2.png", width=12, height=8, units="in", dpi=600)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/plot_hru_hypsometry.r')
plot_hru_hypsometry(hru_peace_200)
View(set_veg_legend)
View(set_veg_legend)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/set_veg_legend.r')
plot_hru_hypsometry(hru_peace_200)
plot_veg_hypsometry(rbind(hru_peace_200, hru_fraser_200, hru_columbia_200))
ggsave("Z:/projects/hydrology/vic_gen2/doc/manuals/vegetation/Figures/veg_hpsometry_200_peace_fraser_columbia.png", wdth=24, height=20, units="cm", dpi=600)
ggsave("Z:/projects/hydrology/vic_gen2/doc/manuals/vegetation/Figures/veg_hpsometry_200_peace_fraser_columbia.png", width=24, height=20, units="cm", dpi=600)
ggsave("Z:/projects/hydrology/vic_gen2/doc/manuals/vegetation/Figures/veg_hpsometry_200_peace_fraser_columbia.png", width=20, height=24, units="cm", dpi=600)
gplot(hru_fraser_200, aes(x=factor(CLASS), y=ELEVATION)) + geom_point()
ggplot(hru_fraser_200, aes(x=factor(CLASS), y=ELEVATION)) + geom_point()
ggplot(hru_fraser_200, aes(x=factor(CLASS), y=ELEVATION)) + geom_point(size=2, alpha=1/5)
ggplot(hru_fraser_200, aes(x=factor(CLASS), y=ELEVATION)) + geom_point(size=2, alpha=1/20)
ggplot(hru_fraser_200, aes(x=factor(CLASS), y=ELEVATION)) + geom_point(size=2, alpha=1/100)
plot_veg_hypsometry(hru_vanisle_200)
View(fraser_cell_map)
View(columbia_cell_map)
View(hru_vanisle_200)
library(readr)
vanisle_cell_map <- read_csv("Z:/projects/hydrology/vic_gen2/input/routing/vanisle_03125/gis/cell_map_working_copy.csv")
View(vanisle_cell_map)
save(hru_vanisle_200, root_depths, vanisle_cell_map, file="../input/vanisle_hires_200.RData")
vanisle_cell_map$NAME==BCCMX
vanisle_cell_map$NAME=="BCCMX"
which(vanisle_cell_map$NAME=="BCCMX")
e <- environment()
str(e)
list(e)
e
ls(e)
match("vanisle_cell_map", ls(e))
match("vanisle_cell_mp", ls(e))
rm(e)
rm(ind)
rm(b)
rm(cells)
View(hru_vanisle_200)
order(hru_vanisle_200$CELL_ID, hru_vanisle_200$BAND_ID)
tmp <- hru_vanisle_200[order(hru_vanisle_200$CELL_ID, hru_vanisle_200$BAND_ID),]
View(tmp)
tmp <- hru_vanisle_200[order(hru_vanisle_200$CELL_ID, hru_vanisle_200$BAND_ID, hru_vanisle_200$CLASS),]
View(tmp)
summarize.df(tmp)
summarizeHRU(tmp)
View(summarizeHRU)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/summarizeHRU.r')
summarizeHRU(tmp)
which(tmp$AREA<1)
tmp[which(tmp$AREA<1),]
tmp[which(tmp$AREA<10),]
tmp[which(tmp$AREA<100),]
str(tmp[,1])
str(tmp[1,])
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/merge.hru.records.r')
merge.hru.records(tmp[76969,], tmp[76968,])
which(tmp$CELL_ID==6008)
merge.hru.records(tmp[83307,], tmp[83306,])
v1 <- 1:10
v2 <- v1[5]
v2
v2 <- v1[-5]
v2
which(tmp$CELL_ID == tmp$CELL_ID[83307])
which(tmp$CELL_ID==tmp$CELL_ID[83307] & tmp$BAND_ID==tmp$BAND_ID[83307])
which(tmp$CELL_ID==tmp$CELL_ID[83306] & tmp$BAND_ID==tmp$BAND_ID[83306])
min(which(tmp$CELL_ID==tmp$CELL_ID[83306] & tmp$BAND_ID==tmp$BAND_ID[83306]))
min(which(tmp$CELL_ID==tmp$CELL_ID[83306] & tmp$BAND_ID==tmp$BAND_ID[83306]) != 83306)
min(which(tmp$CELL_ID==tmp$CELL_ID[83306] & tmp$BAND_ID==tmp$BAND_ID[83306]))
which(tmp$CELL_ID==tmp$CELL_ID[83306] & tmp$BAND_ID==tmp$BAND_ID[83306])
which(which(tmp$CELL_ID==tmp$CELL_ID[83306] & tmp$BAND_ID==tmp$BAND_ID[83306]) != 83306)
ind1 <- which(tmp$CELL_ID==tmp$CELL_ID[83306] & tmp$BAND_ID==tmp$BAND_ID[83306])
which(ind1 != 83306)
ind1[which(ind1 != 83306)]
min(ind1[which(ind1 != 83306)])
ind2 <- min(ind1[which(ind1 != 83306)])
ind1 <- which(tmp$CELL_ID==tmp$CELL_ID[r] & tmp$BAND_ID==tmp$BAND_ID[r])
v <- 1:10
v <- -(1:10)
rm(v)
v1
v2 <- v1[c(-2,-5,-8)]
v2
rm(v1, v2)
which(tmp$AREA < 0)
is.na(which(tmp$AREA < 0))
is.null(which(tmp$AREA < 0))
(which(tmp$AREA < 0))
if(which(tmp$AREA < 0) == 0) print('true')
if(length(which(tmp$AREA < 0)) > 0) print('true')
if(length(which(tmp$AREA < 0)) > 0) print('false')
if(length(which(tmp$AREA < 5000)) > 0) print('true')
which(tmp$AREA<10)
which(tmp$AREA<100)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/remove.hru.records.r')
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/remove.hru.records.r')
tmp2 <- remove.hru.records(tmp)
warnings()
116236-116196
View(tmp2)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/remove.hru.records.r')
rm(tmp2)
tmp2 <- remove.hru.records(tmp)
tmp[84201,]
tmp[84201:84205,]
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/remove.hru.records.r')
tmp2 <- remove.hru.records(tmp)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/remove.hru.records.r')
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/remove.hru.records.r')
tmp2 <- remove.hru.records(tmp)
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/remove.hru.records.r')
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/remove.hru.records.r')
source('Z:/projects/hydrology/vic_gen2/input/vegetation/hru/code/R.git/remove.hru.records.r')
install.packages(c("knitr", "magick", "pillar", "rlang", "stringr"))
library("raster", lib.loc="~/R/win-library/3.4")
library("rasterVis", lib.loc="~/R/win-library/3.4")
View(hru_fraser_200)
which(hru_fraser_200$ELEVATION == 0)
hru_fraser_200[which(hru_fraser_200$ELEVATION == 0),]
summarize.df(hru_fraser_200)
summarizeHRU(hru_fraser_200)
summarizeHRU(hru_columbia_200)
hru_fraser_200[which(hru_fraser_200$BAND_ID == 0),]
hru_fraser_200$BAND_ID[which(hru_fraser_200$BAND_ID == 0)]
hru_fraser_200$BAND_ID[which(hru_fraser_200$BAND_ID == 0)] <- 100
hru_fraser_200[which(hru_fraser_200$BAND_ID == 0),]
hru_fraser_200[which(hru_fraser_200$ELEVATION == 0),]
kicho_200_params$BAND
